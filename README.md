# 忠诚度检测

一个基于浏览器摄像头和姿态识别（MediaPipe Pose）的小玩具。

## 功能

- 点击“开始检测”后：
- 调用摄像头并实时识别动作
- 播放背景音乐 `bgm.mp3`
- 实时计算并显示忠诚度分数
- 动作规则：
- 双手高于肩膀 + 有跳跃趋势 -> 忠诚度回到 `100`
- 否则忠诚度持续下降
- 情绪图切换规则：
- 忠诚度 `>= 80` 持续 `10` 秒 -> 显示图1（微笑）
- 忠诚度 `<= 20` 持续 `5` 秒 -> 显示图2（生气）

## 目录说明

- `index.html` 页面结构
- `style.css` 样式
- `src/app.js` 摄像头、姿态识别、分数和情绪图逻辑
- `src/loyalty.js` 忠诚度核心判定逻辑
- `test/loyalty.test.js` 核心逻辑测试
- `bgm.mp3` 背景音乐
- `img/开心.png` 高分情绪图
- `img/生气.png` 低分情绪图

## 本地运行

1. 进入项目目录：

```bash
cd "/Users/clay/Desktop/忠诚度测试"
```

2. 启动静态服务器（任意一个都可）：

```bash
python3 -m http.server 5500
```

3. 浏览器打开：

`http://localhost:5500`

4. 点击“开始检测”并允许摄像头权限。

## 测试

```bash
npm test
```

## 注意事项

- 建议使用最新版 Chrome/Safari。
- 必须通过 `localhost` 或受信任环境访问，摄像头权限才稳定可用。
- 若页面更新后未生效，请强制刷新：`Cmd + Shift + R`。
